# MATLAB接口

目标是能用MATLAB也进行交易，已经测试通过。能接收行情，能下单，能撤单。<br/>
用户要使用时应当要在MATLAB中对一些API进行封装，否则用起来太麻烦。<br/>
后期考虑模仿Trading Toolbox的调用方式<br/>
指定要加载的库即可使用对应版本的API


## .NET版接口
MATLAB版本与API版本必需完全一样，例如CTP为32位，则MATLAB也得32位。MATLAB调用.NET的机制有问题，可能在长期运行后崩溃。

### 原理
1. MATLAB支持调用.NET库
2. MATLAB支持.NET标准签名的事件
3. 有兴趣的可参考[http://www.ariszheng.com/?p=1883](http://www.ariszheng.com/?p=1883)

### 使用
1. 确保自己安装的是32位MATLAB
2. 打开test.m，编辑开头的路径为本机的实际路径
3. 由于登录下单都写在了一个m文件中了，一次性的执行由于登录是要时间的，还没有登录完成就下单会失败。故请按代码一块块执行。
4. 需要在目录下有XAPI的各个库的文件夹
5. 根据报的错，采用不同的处理方案

## COM版接口
有进程外与进程内两种模式，进程内模式也必须是都是32位或64位。进程外没有限制可以64位调用32位。

### 原理
以进程外方式调用COM组件，实现跨进程的调用

## 使用
1. 64位或32位MATLAB都可以
2. 注册组件
2. 打开test.m，编辑自己的地址与账号
3. 由于登录下单都写在了一个m文件中了，一次性的执行由于登录是要时间的，还没有登录完成就下单会失败。故请按代码一块块执行。
4. 需要在目录下有XAPI的各个库的文件夹
5. 根据报的错，采用不同的处理方案
6. 看是否启动了进程
6. 如果是报win32的错误，那就执行一下clear_InprocServer32.reg

## 其它
1. Kingstar的接口需要提供一个证书，但证书只能在exe当前目录下，所以在登录时，脚本会输出实际运行matlab.exe的路径，必须将证书复制到此目录下才能用。